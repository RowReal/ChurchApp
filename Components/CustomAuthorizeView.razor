@using ChurchApp.Services
@inject AuthService AuthService

@if (AuthService.IsAuthenticated && HasRequiredRole())
{
    @ChildContent
}
else if (!AuthService.IsAuthenticated)
{
    <div class="alert alert-warning">
        <i class="fas fa-exclamation-triangle me-2"></i>
        Please log in to access this content.
    </div>
}
else
{
    <div class="alert alert-danger">
        <i class="fas fa-ban me-2"></i>
        You don't have permission to access this content.
    </div>
}

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public string[] Roles { get; set; } = Array.Empty<string>();
    [Parameter] public bool RequireAdminAccess { get; set; }

    private bool HasRequiredRole()
    {
        if (RequireAdminAccess)
        {
            return AuthService.CanAccessAdminPanel();
        }

        if (Roles?.Any() == true)
        {
            return AuthService.IsInRole(Roles);
        }

        return true; // No specific role required
    }
}
